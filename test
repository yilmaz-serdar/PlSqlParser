SELECT 
    TO_CHAR(TRUNC(TRANSACTION_TIME, 'HH24'), 'YYYY-MM-DD HH24:MI') AS interval_start,
    TO_CHAR(TRUNC(TRANSACTION_TIME, 'HH24') + (1/24), 'YYYY-MM-DD HH24:MI') AS interval_end,
    SUM(USEGE_COUNT) AS total_usege_count
FROM my_table
WHERE SQL_ID = '123234'
GROUP BY TRUNC(TRANSACTION_TIME, 'HH24')
ORDER BY interval_start;

SELECT 
    interval_start,
    interval_end,
    SUM(USEGE_COUNT) AS total_usege_count
FROM (
    SELECT 
        TRANSACTION_TIME,
        TO_CHAR(
            TRUNC(TRANSACTION_TIME, 'HH24') + FLOOR(TO_NUMBER(TO_CHAR(TRANSACTION_TIME, 'MI')) / 30) * (30/1440),
            'YYYY-MM-DD HH24:MI'
        ) AS interval_start,
        TO_CHAR(
            TRUNC(TRANSACTION_TIME, 'HH24') + (FLOOR(TO_NUMBER(TO_CHAR(TRANSACTION_TIME, 'MI')) / 30) + 1) * (30/1440),
            'YYYY-MM-DD HH24:MI'
        ) AS interval_end
    FROM my_table
    WHERE SQL_ID = '123234'
)
GROUP BY interval_start, interval_end
ORDER BY interval_start;
